name: Build & Deploy

on:
  push:
    branches: ["main"]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - uses: actions/setup-node@v3
        with:
          node-version: 16
          cache: "npm"
          cache-dependency-path: package-lock.json
      - run: npm ci
      - run: npm run build

      - name: Deploy to gh-pages
        uses: JamesIves/github-pages-deploy-action@3.7.1
        with:
          # In order for GitHub to trigger the rebuild of your page you must provide the action with the repositories provided GitHub token.
          GITHUB_TOKEN: ${{ secrets.ACTIONS_DEPLOY_KEY }}
          # This is the branch you wish to deploy to, for example gh-pages or docs.
          BRANCH: main
          # The folder in your repository that you want to deploy. If your build script compiles into a directory named build you would put it here. Folder paths cannot have a leading / or ./. If you wish to deploy the root directory you can place a . here.
          FOLDER: public
          # If your project generates hashed files on build you can use this option to automatically delete them from the deployment branch with each deploy. This option can be toggled on by setting it to true.
          CLEAN: false
